<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="lessTemplates">
<title>Continuous-Time-SEM • lessTemplates</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Continuous-Time-SEM">
<meta property="og:description" content="lessTemplates">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lessTemplates</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Continuous-Time-SEM.html">Continuous-Time-SEM</a>
    <a class="dropdown-item" href="../articles/Cross-Lagged-Panel-Model.html">Cross-Lagged-Panel-Model</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Continuous-Time-SEM</h1>
            
      
      
      <div class="d-none name"><code>Continuous-Time-SEM.Rmd</code></div>
    </div>

    
    
<p><strong>lessTemplates</strong> also allows for implementing
continuous time structural euqation models (CTSEM; Voelkle et al., 2012;
Driver et al., 2017). This model allows for unequally spaced measurement
occasions in longitudinal data sets by relying on the assumption that
the dyanmical processes can be explained using stochastic differential
equations. The model is given by</p>
<p><span class="math display">\[\begin{equation}
\text d\pmb \eta(t) = \pmb A \pmb \eta(t)\text dt + \pmb G \text d \pmb
W(t).
\label{eqn:ctsem}
\end{equation}\]</span></p>
<p><span class="math inline">\(\pmb \eta(t)\)</span> is a vector of
latent states at time point <span class="math inline">\(t\)</span>,
<span class="math inline">\(\pmb A\)</span> is the drift-matrix with
auto-effects in the diagonal and cross-effects in the off-diagonal, and
<span class="math inline">\(\pmb W(t)\)</span> is a Wiener process
vector. <span class="math inline">\(\pmb G\)</span> is the diffusion
matrix which influences the variance-covariance matrix of the latent
residuals. A thorough introduction is, for instance, provided by Voelkle
et al. (2012).</p>
<p>Please note that the R packages <a href="https://github.com/driveraus/ctsem" class="external-link"><strong>ctsem</strong></a> and
<a href="https://github.com/driveraus/ctsemOMX" class="external-link"><strong>ctsemOMX</strong></a>
(Driver et al., 2017) provide more stable implementations of CTSEM and
<a href="https://github.com/jhorzek/regCtsem" class="external-link"><strong>regCtsem</strong></a>
is a specialized package which allows for regularization of such models
(Orzek &amp; Voelkle, In Press). In practice, you may find that
<strong>ctsem</strong> and <strong>regCtsem</strong> are faster than the
implementation in <strong>lessTemplates</strong>. The objective of the
CTSEM implementation in <strong>lessTemplates</strong> is to show the
versatility of <strong>lessSEM</strong>, not to provide an alternative
to existing implementations.</p>
<div class="section level2">
<h2 id="the-data-set">The Data Set<a class="anchor" aria-label="anchor" href="#the-data-set"></a>
</h2>
<p><strong>lessTemplates</strong> expects the data to be given in long
format, with a column named <code>person</code> and a column named
<code>time</code>. We will use the <code>AnomAuth</code> data set in the
following (Voelkle et al., 2012; Driver et al., 2017):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cdriveraus/ctsemOMX" class="external-link">ctsemOMX</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"AnomAuth"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">AnomAuth</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Y1_T0 Y2_T0 Y1_T1 Y2_T1 Y1_T2 Y2_T2 Y1_T3 Y2_T3 Y1_T4 Y2_T4 dT1 dT2 dT3 dT4</span></span>
<span><span class="co">#&gt; 1  2.67  3.50  3.33   3.5    NA    NA    NA    NA    NA    NA   1   1   2   2</span></span>
<span><span class="co">#&gt; 2  3.33  3.25    NA    NA    NA    NA    NA    NA    NA    NA   1   1   2   2</span></span>
<span><span class="co">#&gt; 3  3.33  2.75  3.33   3.0  3.33   2.5  2.33     3  2.33     3   1   1   2   2</span></span>
<span><span class="co">#&gt; 4  3.33  3.25    NA    NA    NA    NA    NA    NA    NA    NA   1   1   2   2</span></span>
<span><span class="co">#&gt; 5  4.00  4.00    NA    NA    NA    NA    NA    NA    NA    NA   1   1   2   2</span></span>
<span><span class="co">#&gt; 6  3.67  4.00    NA    NA    NA    NA  4.00     4  4.00     4   1   1   2   2</span></span></code></pre></div>
<p>Note that the data is in long format, not in wide format. We can
transform the data set using <strong>ctsemOMX</strong>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># from long to wide</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctWideToLong.html" class="external-link">ctWideToLong</a></span><span class="op">(</span>datawide <span class="op">=</span> <span class="va">AnomAuth</span>,</span>
<span>                     Tpoints<span class="op">=</span> <span class="fl">5</span>,</span>
<span>                     n.manifest<span class="op">=</span><span class="fl">2</span>,</span>
<span>                     manifestNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>, <span class="st">"Y2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctDeintervalise.html" class="external-link">ctDeintervalise</a></span><span class="op">(</span>datalong <span class="op">=</span> <span class="va">data</span>, </span>
<span>                        id<span class="op">=</span><span class="st">'id'</span>, </span>
<span>                        dT<span class="op">=</span><span class="st">'dT'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Converting intervals to absolute time:  Any missing intervals on 1st row of each subject are assumed to occur at earliest measurement time (0), any other missing intervals render subsequent intervals for the subject unusable so time variables are set NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"person"</span>, <span class="st">"time"</span>, <span class="st">"Y1"</span>, <span class="st">"Y2"</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Y1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Y2</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;    person time   Y1   Y2</span></span>
<span><span class="co">#&gt; 1       1    0 2.67 3.50</span></span>
<span><span class="co">#&gt; 2       1    1 3.33 3.50</span></span>
<span><span class="co">#&gt; 6       2    0 3.33 3.25</span></span>
<span><span class="co">#&gt; 11      3    0 3.33 2.75</span></span>
<span><span class="co">#&gt; 12      3    1 3.33 3.00</span></span>
<span><span class="co">#&gt; 13      3    2 3.33 2.50</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="specifying-the-ctsem">Specifying the CTSEM<a class="anchor" aria-label="anchor" href="#specifying-the-ctsem"></a>
</h2>
<p>The model syntax is similar to the mathematical notation shown in the
equations above.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st"># Specify the latent dynamics in differential equation model notation:</span></span>
<span><span class="st">d_eta1(t) ~ eta1(t) + eta2(t)</span></span>
<span><span class="st">d_eta2(t) ~ eta1(t) + eta2(t)</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Covariances (Wiener process)</span></span>
<span><span class="st">d_eta1(t) ~~ d_eta1(t) + d_eta2(t)</span></span>
<span><span class="st">d_eta2(t) ~~ d_eta2(t)</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Latent intercepts</span></span>
<span><span class="st">eta1(0) ~ 1</span></span>
<span><span class="st">eta2(0) ~ 1</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Measurement model</span></span>
<span><span class="st">eta1(t) =~ 1*Y1(t)</span></span>
<span><span class="st">eta2(t) =~ 1*Y2(t)</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Manifest variances and covariances</span></span>
<span><span class="st">Y1(t) ~~ 0*Y1(t) + 0*Y2(t)</span></span>
<span><span class="st">Y2(t) ~~ 0*Y2(t)</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Manifest intercepts</span></span>
<span><span class="st">Y1(t) ~ m1*1</span></span>
<span><span class="st">Y2(t) ~ m2*1</span></span>
<span><span class="st">"</span></span></code></pre></div>
<p>Note the special notation:</p>
<ol style="list-style-type: decimal">
<li>A variable starting with <code>d_</code> is assumed to be a
differential that is predicted using the current states of the latent
variables.</li>
<li>If a variable is time-dependent, this is denoted with the special
operator <code>(t)</code>.</li>
</ol>
<p>Currently, we can only use latent, time-dependent variables as
predictors in the dynamical equations. The following is not allowed:
<code>d_eta1(t) ~ eta1(t) + kappa</code>. This is because
<code>kappa</code> is not time-dependent.</p>
</div>
<div class="section level2">
<h2 id="using-ctsem-to-build-the-model">Using <code>CTSEM</code> to build the model<a class="anchor" aria-label="anchor" href="#using-ctsem-to-build-the-model"></a>
</h2>
<p>CTSEM is implemented in <strong>lessTemplates</strong> using the
transformations of <strong>lessSEM</strong> (see
<code><a href="https://cran.rstudio.com/web/packages/lessSEM/vignettes/Parameter-transformations.html" class="external-link">vignette(topic = "Parameter-transformations", package = "lessSEM")</a></code>
for more details).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ctsem</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CTSEM.html">CTSEM</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>, </span>
<span>               data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting up a continuous time structural equation model.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ctsem</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "lavaanModel"        "transformation"     "transformationList"</span></span>
<span><span class="co">#&gt; [4] "internal"</span></span></code></pre></div>
<p>The created object has two elements of relevance in the following: A
lavaan object (<code>lavaanModel</code>) and the transformations
necessary to build a CTSEM from this lavaan object
(<code>transformation</code>).</p>
<details><summary>
Show lavaan model details
</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ctsem</span><span class="op">$</span><span class="va">lavaanModel</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6.15 did not run (perhaps do.fit = FALSE)?</span></span>
<span><span class="co">#&gt; ** WARNING ** Estimates below are simply the starting values</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        43</span></span>
<span><span class="co">#&gt;   Number of equality constraints                     8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                          2722</span></span>
<span><span class="co">#&gt;   Number of missing patterns                        12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;   eta1_u1 =~               </span></span>
<span><span class="co">#&gt;     Y1_u1             1.000</span></span>
<span><span class="co">#&gt;     Y2_u1             0.000</span></span>
<span><span class="co">#&gt;     Y1_u2             0.000</span></span>
<span><span class="co">#&gt;     Y2_u2             0.000</span></span>
<span><span class="co">#&gt;     Y1_u3             0.000</span></span>
<span><span class="co">#&gt;     Y2_u3             0.000</span></span>
<span><span class="co">#&gt;     Y1_u4             0.000</span></span>
<span><span class="co">#&gt;     Y2_u4             0.000</span></span>
<span><span class="co">#&gt;     Y1_u5             0.000</span></span>
<span><span class="co">#&gt;     Y2_u5             0.000</span></span>
<span><span class="co">#&gt;   eta2_u1 =~               </span></span>
<span><span class="co">#&gt;     Y1_u1             0.000</span></span>
<span><span class="co">#&gt;     Y2_u1             1.000</span></span>
<span><span class="co">#&gt;     Y1_u2             0.000</span></span>
<span><span class="co">#&gt;     Y2_u2             0.000</span></span>
<span><span class="co">#&gt;     Y1_u3             0.000</span></span>
<span><span class="co">#&gt;     Y2_u3             0.000</span></span>
<span><span class="co">#&gt;     Y1_u4             0.000</span></span>
<span><span class="co">#&gt;     Y2_u4             0.000</span></span>
<span><span class="co">#&gt;     Y1_u5             0.000</span></span>
<span><span class="co">#&gt;     Y2_u5             0.000</span></span>
<span><span class="co">#&gt;   eta1_u2 =~               </span></span>
<span><span class="co">#&gt;     Y1_u1             0.000</span></span>
<span><span class="co">#&gt;     Y2_u1             0.000</span></span>
<span><span class="co">#&gt;     Y1_u2             1.000</span></span>
<span><span class="co">#&gt;     Y2_u2             0.000</span></span>
<span><span class="co">#&gt;     Y1_u3             0.000</span></span>
<span><span class="co">#&gt;     Y2_u3             0.000</span></span>
<span><span class="co">#&gt;     Y1_u4             0.000</span></span>
<span><span class="co">#&gt;     Y2_u4             0.000</span></span>
<span><span class="co">#&gt;     Y1_u5             0.000</span></span>
<span><span class="co">#&gt;     Y2_u5             0.000</span></span>
<span><span class="co">#&gt;   eta2_u2 =~               </span></span>
<span><span class="co">#&gt;     Y1_u1             0.000</span></span>
<span><span class="co">#&gt;     Y2_u1             0.000</span></span>
<span><span class="co">#&gt;     Y1_u2             0.000</span></span>
<span><span class="co">#&gt;     Y2_u2             1.000</span></span>
<span><span class="co">#&gt;     Y1_u3             0.000</span></span>
<span><span class="co">#&gt;     Y2_u3             0.000</span></span>
<span><span class="co">#&gt;     Y1_u4             0.000</span></span>
<span><span class="co">#&gt;     Y2_u4             0.000</span></span>
<span><span class="co">#&gt;     Y1_u5             0.000</span></span>
<span><span class="co">#&gt;     Y2_u5             0.000</span></span>
<span><span class="co">#&gt;   eta1_u3 =~               </span></span>
<span><span class="co">#&gt;     Y1_u1             0.000</span></span>
<span><span class="co">#&gt;     Y2_u1             0.000</span></span>
<span><span class="co">#&gt;     Y1_u2             0.000</span></span>
<span><span class="co">#&gt;     Y2_u2             0.000</span></span>
<span><span class="co">#&gt;     Y1_u3             1.000</span></span>
<span><span class="co">#&gt;     Y2_u3             0.000</span></span>
<span><span class="co">#&gt;     Y1_u4             0.000</span></span>
<span><span class="co">#&gt;     Y2_u4             0.000</span></span>
<span><span class="co">#&gt;     Y1_u5             0.000</span></span>
<span><span class="co">#&gt;     Y2_u5             0.000</span></span>
<span><span class="co">#&gt;   eta2_u3 =~               </span></span>
<span><span class="co">#&gt;     Y1_u1             0.000</span></span>
<span><span class="co">#&gt;     Y2_u1             0.000</span></span>
<span><span class="co">#&gt;     Y1_u2             0.000</span></span>
<span><span class="co">#&gt;     Y2_u2             0.000</span></span>
<span><span class="co">#&gt;     Y1_u3             0.000</span></span>
<span><span class="co">#&gt;     Y2_u3             1.000</span></span>
<span><span class="co">#&gt;     Y1_u4             0.000</span></span>
<span><span class="co">#&gt;     Y2_u4             0.000</span></span>
<span><span class="co">#&gt;     Y1_u5             0.000</span></span>
<span><span class="co">#&gt;     Y2_u5             0.000</span></span>
<span><span class="co">#&gt;   eta1_u4 =~               </span></span>
<span><span class="co">#&gt;     Y1_u1             0.000</span></span>
<span><span class="co">#&gt;     Y2_u1             0.000</span></span>
<span><span class="co">#&gt;     Y1_u2             0.000</span></span>
<span><span class="co">#&gt;     Y2_u2             0.000</span></span>
<span><span class="co">#&gt;     Y1_u3             0.000</span></span>
<span><span class="co">#&gt;     Y2_u3             0.000</span></span>
<span><span class="co">#&gt;     Y1_u4             1.000</span></span>
<span><span class="co">#&gt;     Y2_u4             0.000</span></span>
<span><span class="co">#&gt;     Y1_u5             0.000</span></span>
<span><span class="co">#&gt;     Y2_u5             0.000</span></span>
<span><span class="co">#&gt;   eta2_u4 =~               </span></span>
<span><span class="co">#&gt;     Y1_u1             0.000</span></span>
<span><span class="co">#&gt;     Y2_u1             0.000</span></span>
<span><span class="co">#&gt;     Y1_u2             0.000</span></span>
<span><span class="co">#&gt;     Y2_u2             0.000</span></span>
<span><span class="co">#&gt;     Y1_u3             0.000</span></span>
<span><span class="co">#&gt;     Y2_u3             0.000</span></span>
<span><span class="co">#&gt;     Y1_u4             0.000</span></span>
<span><span class="co">#&gt;     Y2_u4             1.000</span></span>
<span><span class="co">#&gt;     Y1_u5             0.000</span></span>
<span><span class="co">#&gt;     Y2_u5             0.000</span></span>
<span><span class="co">#&gt;   eta1_u5 =~               </span></span>
<span><span class="co">#&gt;     Y1_u1             0.000</span></span>
<span><span class="co">#&gt;     Y2_u1             0.000</span></span>
<span><span class="co">#&gt;     Y1_u2             0.000</span></span>
<span><span class="co">#&gt;     Y2_u2             0.000</span></span>
<span><span class="co">#&gt;     Y1_u3             0.000</span></span>
<span><span class="co">#&gt;     Y2_u3             0.000</span></span>
<span><span class="co">#&gt;     Y1_u4             0.000</span></span>
<span><span class="co">#&gt;     Y2_u4             0.000</span></span>
<span><span class="co">#&gt;     Y1_u5             1.000</span></span>
<span><span class="co">#&gt;     Y2_u5             0.000</span></span>
<span><span class="co">#&gt;   eta2_u5 =~               </span></span>
<span><span class="co">#&gt;     Y1_u1             0.000</span></span>
<span><span class="co">#&gt;     Y2_u1             0.000</span></span>
<span><span class="co">#&gt;     Y1_u2             0.000</span></span>
<span><span class="co">#&gt;     Y2_u2             0.000</span></span>
<span><span class="co">#&gt;     Y1_u3             0.000</span></span>
<span><span class="co">#&gt;     Y2_u3             0.000</span></span>
<span><span class="co">#&gt;     Y1_u4             0.000</span></span>
<span><span class="co">#&gt;     Y2_u4             0.000</span></span>
<span><span class="co">#&gt;     Y1_u5             0.000</span></span>
<span><span class="co">#&gt;     Y2_u5             1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;   eta1_u2 ~                </span></span>
<span><span class="co">#&gt;     Y1_1              0.000</span></span>
<span><span class="co">#&gt;     Y2_1              0.000</span></span>
<span><span class="co">#&gt;     Y1_2              0.000</span></span>
<span><span class="co">#&gt;     Y2_2              0.000</span></span>
<span><span class="co">#&gt;     Y1_3              0.000</span></span>
<span><span class="co">#&gt;     Y2_3              0.000</span></span>
<span><span class="co">#&gt;     Y1_4              0.000</span></span>
<span><span class="co">#&gt;     Y2_4              0.000</span></span>
<span><span class="co">#&gt;     Y1_5              0.000</span></span>
<span><span class="co">#&gt;     Y2_5              0.000</span></span>
<span><span class="co">#&gt;     e1_1 (a_1_1_2)    0.000</span></span>
<span><span class="co">#&gt;     e2_1 (a_1_2_2)    0.000</span></span>
<span><span class="co">#&gt;     e2_2              0.000</span></span>
<span><span class="co">#&gt;     e1_3              0.000</span></span>
<span><span class="co">#&gt;     e2_3              0.000</span></span>
<span><span class="co">#&gt;     e1_4              0.000</span></span>
<span><span class="co">#&gt;     e2_4              0.000</span></span>
<span><span class="co">#&gt;     e1_5              0.000</span></span>
<span><span class="co">#&gt;     e2_5              0.000</span></span>
<span><span class="co">#&gt;   eta2_u2 ~                </span></span>
<span><span class="co">#&gt;     Y1_1              0.000</span></span>
<span><span class="co">#&gt;     Y2_1              0.000</span></span>
<span><span class="co">#&gt;     Y1_2              0.000</span></span>
<span><span class="co">#&gt;     Y2_2              0.000</span></span>
<span><span class="co">#&gt;     Y1_3              0.000</span></span>
<span><span class="co">#&gt;     Y2_3              0.000</span></span>
<span><span class="co">#&gt;     Y1_4              0.000</span></span>
<span><span class="co">#&gt;     Y2_4              0.000</span></span>
<span><span class="co">#&gt;     Y1_5              0.000</span></span>
<span><span class="co">#&gt;     Y2_5              0.000</span></span>
<span><span class="co">#&gt;     e1_1 (a_2_1_2)    0.000</span></span>
<span><span class="co">#&gt;     e2_1 (a_2_2_2)    0.000</span></span>
<span><span class="co">#&gt;     e1_2              0.000</span></span>
<span><span class="co">#&gt;     e1_3              0.000</span></span>
<span><span class="co">#&gt;     e2_3              0.000</span></span>
<span><span class="co">#&gt;     e1_4              0.000</span></span>
<span><span class="co">#&gt;     e2_4              0.000</span></span>
<span><span class="co">#&gt;     e1_5              0.000</span></span>
<span><span class="co">#&gt;     e2_5              0.000</span></span>
<span><span class="co">#&gt;   eta1_u3 ~                </span></span>
<span><span class="co">#&gt;     Y1_1              0.000</span></span>
<span><span class="co">#&gt;     Y2_1              0.000</span></span>
<span><span class="co">#&gt;     Y1_2              0.000</span></span>
<span><span class="co">#&gt;     Y2_2              0.000</span></span>
<span><span class="co">#&gt;     Y1_3              0.000</span></span>
<span><span class="co">#&gt;     Y2_3              0.000</span></span>
<span><span class="co">#&gt;     Y1_4              0.000</span></span>
<span><span class="co">#&gt;     Y2_4              0.000</span></span>
<span><span class="co">#&gt;     Y1_5              0.000</span></span>
<span><span class="co">#&gt;     Y2_5              0.000</span></span>
<span><span class="co">#&gt;     e1_1              0.000</span></span>
<span><span class="co">#&gt;     e2_1              0.000</span></span>
<span><span class="co">#&gt;     e1_2 (a_1_1_3)    0.000</span></span>
<span><span class="co">#&gt;     e2_2 (a_1_2_3)    0.000</span></span>
<span><span class="co">#&gt;     e2_3              0.000</span></span>
<span><span class="co">#&gt;     e1_4              0.000</span></span>
<span><span class="co">#&gt;     e2_4              0.000</span></span>
<span><span class="co">#&gt;     e1_5              0.000</span></span>
<span><span class="co">#&gt;     e2_5              0.000</span></span>
<span><span class="co">#&gt;   eta2_u3 ~                </span></span>
<span><span class="co">#&gt;     Y1_1              0.000</span></span>
<span><span class="co">#&gt;     Y2_1              0.000</span></span>
<span><span class="co">#&gt;     Y1_2              0.000</span></span>
<span><span class="co">#&gt;     Y2_2              0.000</span></span>
<span><span class="co">#&gt;     Y1_3              0.000</span></span>
<span><span class="co">#&gt;     Y2_3              0.000</span></span>
<span><span class="co">#&gt;     Y1_4              0.000</span></span>
<span><span class="co">#&gt;     Y2_4              0.000</span></span>
<span><span class="co">#&gt;     Y1_5              0.000</span></span>
<span><span class="co">#&gt;     Y2_5              0.000</span></span>
<span><span class="co">#&gt;     e1_1              0.000</span></span>
<span><span class="co">#&gt;     e2_1              0.000</span></span>
<span><span class="co">#&gt;     e1_2 (a_2_1_3)    0.000</span></span>
<span><span class="co">#&gt;     e2_2 (a_2_2_3)    0.000</span></span>
<span><span class="co">#&gt;     e1_3              0.000</span></span>
<span><span class="co">#&gt;     e1_4              0.000</span></span>
<span><span class="co">#&gt;     e2_4              0.000</span></span>
<span><span class="co">#&gt;     e1_5              0.000</span></span>
<span><span class="co">#&gt;     e2_5              0.000</span></span>
<span><span class="co">#&gt;   eta1_u4 ~                </span></span>
<span><span class="co">#&gt;     Y1_1              0.000</span></span>
<span><span class="co">#&gt;     Y2_1              0.000</span></span>
<span><span class="co">#&gt;     Y1_2              0.000</span></span>
<span><span class="co">#&gt;     Y2_2              0.000</span></span>
<span><span class="co">#&gt;     Y1_3              0.000</span></span>
<span><span class="co">#&gt;     Y2_3              0.000</span></span>
<span><span class="co">#&gt;     Y1_4              0.000</span></span>
<span><span class="co">#&gt;     Y2_4              0.000</span></span>
<span><span class="co">#&gt;     Y1_5              0.000</span></span>
<span><span class="co">#&gt;     Y2_5              0.000</span></span>
<span><span class="co">#&gt;     e1_1              0.000</span></span>
<span><span class="co">#&gt;     e2_1              0.000</span></span>
<span><span class="co">#&gt;     e1_2              0.000</span></span>
<span><span class="co">#&gt;     e2_2              0.000</span></span>
<span><span class="co">#&gt;     e1_3 (a_1_1_4)    0.000</span></span>
<span><span class="co">#&gt;     e2_3 (a_1_2_4)    0.000</span></span>
<span><span class="co">#&gt;     e2_4              0.000</span></span>
<span><span class="co">#&gt;     e1_5              0.000</span></span>
<span><span class="co">#&gt;     e2_5              0.000</span></span>
<span><span class="co">#&gt;   eta2_u4 ~                </span></span>
<span><span class="co">#&gt;     Y1_1              0.000</span></span>
<span><span class="co">#&gt;     Y2_1              0.000</span></span>
<span><span class="co">#&gt;     Y1_2              0.000</span></span>
<span><span class="co">#&gt;     Y2_2              0.000</span></span>
<span><span class="co">#&gt;     Y1_3              0.000</span></span>
<span><span class="co">#&gt;     Y2_3              0.000</span></span>
<span><span class="co">#&gt;     Y1_4              0.000</span></span>
<span><span class="co">#&gt;     Y2_4              0.000</span></span>
<span><span class="co">#&gt;     Y1_5              0.000</span></span>
<span><span class="co">#&gt;     Y2_5              0.000</span></span>
<span><span class="co">#&gt;     e1_1              0.000</span></span>
<span><span class="co">#&gt;     e2_1              0.000</span></span>
<span><span class="co">#&gt;     e1_2              0.000</span></span>
<span><span class="co">#&gt;     e2_2              0.000</span></span>
<span><span class="co">#&gt;     e1_3 (a_2_1_4)    0.000</span></span>
<span><span class="co">#&gt;     e2_3 (a_2_2_4)    0.000</span></span>
<span><span class="co">#&gt;     e1_4              0.000</span></span>
<span><span class="co">#&gt;     e1_5              0.000</span></span>
<span><span class="co">#&gt;     e2_5              0.000</span></span>
<span><span class="co">#&gt;   eta1_u5 ~                </span></span>
<span><span class="co">#&gt;     Y1_1              0.000</span></span>
<span><span class="co">#&gt;     Y2_1              0.000</span></span>
<span><span class="co">#&gt;     Y1_2              0.000</span></span>
<span><span class="co">#&gt;     Y2_2              0.000</span></span>
<span><span class="co">#&gt;     Y1_3              0.000</span></span>
<span><span class="co">#&gt;     Y2_3              0.000</span></span>
<span><span class="co">#&gt;     Y1_4              0.000</span></span>
<span><span class="co">#&gt;     Y2_4              0.000</span></span>
<span><span class="co">#&gt;     Y1_5              0.000</span></span>
<span><span class="co">#&gt;     Y2_5              0.000</span></span>
<span><span class="co">#&gt;     e1_1              0.000</span></span>
<span><span class="co">#&gt;     e2_1              0.000</span></span>
<span><span class="co">#&gt;     e1_2              0.000</span></span>
<span><span class="co">#&gt;     e2_2              0.000</span></span>
<span><span class="co">#&gt;     e1_3              0.000</span></span>
<span><span class="co">#&gt;     e2_3              0.000</span></span>
<span><span class="co">#&gt;     e1_4 (a_1_1_5)    0.000</span></span>
<span><span class="co">#&gt;     e2_4 (a_1_2_5)    0.000</span></span>
<span><span class="co">#&gt;     e2_5              0.000</span></span>
<span><span class="co">#&gt;   eta2_u5 ~                </span></span>
<span><span class="co">#&gt;     Y1_1              0.000</span></span>
<span><span class="co">#&gt;     Y2_1              0.000</span></span>
<span><span class="co">#&gt;     Y1_2              0.000</span></span>
<span><span class="co">#&gt;     Y2_2              0.000</span></span>
<span><span class="co">#&gt;     Y1_3              0.000</span></span>
<span><span class="co">#&gt;     Y2_3              0.000</span></span>
<span><span class="co">#&gt;     Y1_4              0.000</span></span>
<span><span class="co">#&gt;     Y2_4              0.000</span></span>
<span><span class="co">#&gt;     Y1_5              0.000</span></span>
<span><span class="co">#&gt;     Y2_5              0.000</span></span>
<span><span class="co">#&gt;     e1_1              0.000</span></span>
<span><span class="co">#&gt;     e2_1              0.000</span></span>
<span><span class="co">#&gt;     e1_2              0.000</span></span>
<span><span class="co">#&gt;     e2_2              0.000</span></span>
<span><span class="co">#&gt;     e1_3              0.000</span></span>
<span><span class="co">#&gt;     e2_3              0.000</span></span>
<span><span class="co">#&gt;     e1_4 (a_2_1_5)    0.000</span></span>
<span><span class="co">#&gt;     e2_4 (a_2_2_5)    0.000</span></span>
<span><span class="co">#&gt;     e1_5              0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;  .Y1_u1 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_1              0.000</span></span>
<span><span class="co">#&gt;    .Y1_2              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u1 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_2              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u1 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_2              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u1 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_2              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u2 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_2              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u1 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_3              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u1 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_3              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u2 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_3              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u2 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_3              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u1 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_3              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u1 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_3              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u2 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_3              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u2 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_3              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u3 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_3              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u1 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_4              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u1 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_4              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u2 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_4              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u2 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_4              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u3 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_4              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u3 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_4              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u1 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u1 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u2 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u2 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u3 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u3 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u4 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u1 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u1 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u2 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u2 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u3 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u3 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u4 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u4 ~~                 </span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u1 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u1 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u2 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u2 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u3 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u3 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u4 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;  .Y2_u4 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;  .Y1_u5 ~~                 </span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;   eta1_u1 ~~               </span></span>
<span><span class="co">#&gt;    .Y1_1              0.000</span></span>
<span><span class="co">#&gt;    .Y2_1              0.000</span></span>
<span><span class="co">#&gt;    .Y1_2              0.000</span></span>
<span><span class="co">#&gt;    .Y2_2              0.000</span></span>
<span><span class="co">#&gt;    .Y1_3              0.000</span></span>
<span><span class="co">#&gt;    .Y2_3              0.000</span></span>
<span><span class="co">#&gt;    .Y1_4              0.000</span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;   eta2_u1 ~~               </span></span>
<span><span class="co">#&gt;    .Y1_1              0.000</span></span>
<span><span class="co">#&gt;    .Y2_1              0.000</span></span>
<span><span class="co">#&gt;    .Y1_2              0.000</span></span>
<span><span class="co">#&gt;    .Y2_2              0.000</span></span>
<span><span class="co">#&gt;    .Y1_3              0.000</span></span>
<span><span class="co">#&gt;    .Y2_3              0.000</span></span>
<span><span class="co">#&gt;    .Y1_4              0.000</span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;   eta1_u1 ~~               </span></span>
<span><span class="co">#&gt;     e2_1    (iC_2)    0.000</span></span>
<span><span class="co">#&gt;  .eta1_u2 ~~               </span></span>
<span><span class="co">#&gt;    .Y1_1              0.000</span></span>
<span><span class="co">#&gt;    .Y2_1              0.000</span></span>
<span><span class="co">#&gt;    .Y1_2              0.000</span></span>
<span><span class="co">#&gt;    .Y2_2              0.000</span></span>
<span><span class="co">#&gt;    .Y1_3              0.000</span></span>
<span><span class="co">#&gt;    .Y2_3              0.000</span></span>
<span><span class="co">#&gt;    .Y1_4              0.000</span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;   eta1_u1 ~~               </span></span>
<span><span class="co">#&gt;    .e1_2              0.000</span></span>
<span><span class="co">#&gt;   eta2_u1 ~~               </span></span>
<span><span class="co">#&gt;    .e1_2              0.000</span></span>
<span><span class="co">#&gt;  .eta2_u2 ~~               </span></span>
<span><span class="co">#&gt;    .Y1_1              0.000</span></span>
<span><span class="co">#&gt;    .Y2_1              0.000</span></span>
<span><span class="co">#&gt;    .Y1_2              0.000</span></span>
<span><span class="co">#&gt;    .Y2_2              0.000</span></span>
<span><span class="co">#&gt;    .Y1_3              0.000</span></span>
<span><span class="co">#&gt;    .Y2_3              0.000</span></span>
<span><span class="co">#&gt;    .Y1_4              0.000</span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;   eta1_u1 ~~               </span></span>
<span><span class="co">#&gt;    .e2_2              0.000</span></span>
<span><span class="co">#&gt;   eta2_u1 ~~               </span></span>
<span><span class="co">#&gt;    .e2_2              0.000</span></span>
<span><span class="co">#&gt;  .eta1_u2 ~~               </span></span>
<span><span class="co">#&gt;    .e2_2 (c_2_1_2)    0.000</span></span>
<span><span class="co">#&gt;  .eta1_u3 ~~               </span></span>
<span><span class="co">#&gt;    .Y1_1              0.000</span></span>
<span><span class="co">#&gt;    .Y2_1              0.000</span></span>
<span><span class="co">#&gt;    .Y1_2              0.000</span></span>
<span><span class="co">#&gt;    .Y2_2              0.000</span></span>
<span><span class="co">#&gt;    .Y1_3              0.000</span></span>
<span><span class="co">#&gt;    .Y2_3              0.000</span></span>
<span><span class="co">#&gt;    .Y1_4              0.000</span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;   eta1_u1 ~~               </span></span>
<span><span class="co">#&gt;    .e1_3              0.000</span></span>
<span><span class="co">#&gt;   eta2_u1 ~~               </span></span>
<span><span class="co">#&gt;    .e1_3              0.000</span></span>
<span><span class="co">#&gt;  .eta1_u2 ~~               </span></span>
<span><span class="co">#&gt;    .e1_3              0.000</span></span>
<span><span class="co">#&gt;  .eta2_u2 ~~               </span></span>
<span><span class="co">#&gt;    .e1_3              0.000</span></span>
<span><span class="co">#&gt;  .eta2_u3 ~~               </span></span>
<span><span class="co">#&gt;    .Y1_1              0.000</span></span>
<span><span class="co">#&gt;    .Y2_1              0.000</span></span>
<span><span class="co">#&gt;    .Y1_2              0.000</span></span>
<span><span class="co">#&gt;    .Y2_2              0.000</span></span>
<span><span class="co">#&gt;    .Y1_3              0.000</span></span>
<span><span class="co">#&gt;    .Y2_3              0.000</span></span>
<span><span class="co">#&gt;    .Y1_4              0.000</span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;   eta1_u1 ~~               </span></span>
<span><span class="co">#&gt;    .e2_3              0.000</span></span>
<span><span class="co">#&gt;   eta2_u1 ~~               </span></span>
<span><span class="co">#&gt;    .e2_3              0.000</span></span>
<span><span class="co">#&gt;  .eta1_u2 ~~               </span></span>
<span><span class="co">#&gt;    .e2_3              0.000</span></span>
<span><span class="co">#&gt;  .eta2_u2 ~~               </span></span>
<span><span class="co">#&gt;    .e2_3              0.000</span></span>
<span><span class="co">#&gt;  .eta1_u3 ~~               </span></span>
<span><span class="co">#&gt;    .e2_3 (c_2_1_3)    0.000</span></span>
<span><span class="co">#&gt;  .eta1_u4 ~~               </span></span>
<span><span class="co">#&gt;    .Y1_1              0.000</span></span>
<span><span class="co">#&gt;    .Y2_1              0.000</span></span>
<span><span class="co">#&gt;    .Y1_2              0.000</span></span>
<span><span class="co">#&gt;    .Y2_2              0.000</span></span>
<span><span class="co">#&gt;    .Y1_3              0.000</span></span>
<span><span class="co">#&gt;    .Y2_3              0.000</span></span>
<span><span class="co">#&gt;    .Y1_4              0.000</span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;   eta1_u1 ~~               </span></span>
<span><span class="co">#&gt;    .e1_4              0.000</span></span>
<span><span class="co">#&gt;   eta2_u1 ~~               </span></span>
<span><span class="co">#&gt;    .e1_4              0.000</span></span>
<span><span class="co">#&gt;  .eta1_u2 ~~               </span></span>
<span><span class="co">#&gt;    .e1_4              0.000</span></span>
<span><span class="co">#&gt;  .eta2_u2 ~~               </span></span>
<span><span class="co">#&gt;    .e1_4              0.000</span></span>
<span><span class="co">#&gt;  .eta1_u3 ~~               </span></span>
<span><span class="co">#&gt;    .e1_4              0.000</span></span>
<span><span class="co">#&gt;  .eta2_u3 ~~               </span></span>
<span><span class="co">#&gt;    .e1_4              0.000</span></span>
<span><span class="co">#&gt;  .eta2_u4 ~~               </span></span>
<span><span class="co">#&gt;    .Y1_1              0.000</span></span>
<span><span class="co">#&gt;    .Y2_1              0.000</span></span>
<span><span class="co">#&gt;    .Y1_2              0.000</span></span>
<span><span class="co">#&gt;    .Y2_2              0.000</span></span>
<span><span class="co">#&gt;    .Y1_3              0.000</span></span>
<span><span class="co">#&gt;    .Y2_3              0.000</span></span>
<span><span class="co">#&gt;    .Y1_4              0.000</span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;   eta1_u1 ~~               </span></span>
<span><span class="co">#&gt;    .e2_4              0.000</span></span>
<span><span class="co">#&gt;   eta2_u1 ~~               </span></span>
<span><span class="co">#&gt;    .e2_4              0.000</span></span>
<span><span class="co">#&gt;  .eta1_u2 ~~               </span></span>
<span><span class="co">#&gt;    .e2_4              0.000</span></span>
<span><span class="co">#&gt;  .eta2_u2 ~~               </span></span>
<span><span class="co">#&gt;    .e2_4              0.000</span></span>
<span><span class="co">#&gt;  .eta1_u3 ~~               </span></span>
<span><span class="co">#&gt;    .e2_4              0.000</span></span>
<span><span class="co">#&gt;  .eta2_u3 ~~               </span></span>
<span><span class="co">#&gt;    .e2_4              0.000</span></span>
<span><span class="co">#&gt;  .eta1_u4 ~~               </span></span>
<span><span class="co">#&gt;    .e2_4 (c_2_1_4)    0.000</span></span>
<span><span class="co">#&gt;  .eta1_u5 ~~               </span></span>
<span><span class="co">#&gt;    .Y1_1              0.000</span></span>
<span><span class="co">#&gt;    .Y2_1              0.000</span></span>
<span><span class="co">#&gt;    .Y1_2              0.000</span></span>
<span><span class="co">#&gt;    .Y2_2              0.000</span></span>
<span><span class="co">#&gt;    .Y1_3              0.000</span></span>
<span><span class="co">#&gt;    .Y2_3              0.000</span></span>
<span><span class="co">#&gt;    .Y1_4              0.000</span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;   eta1_u1 ~~               </span></span>
<span><span class="co">#&gt;    .e1_5              0.000</span></span>
<span><span class="co">#&gt;   eta2_u1 ~~               </span></span>
<span><span class="co">#&gt;    .e1_5              0.000</span></span>
<span><span class="co">#&gt;  .eta1_u2 ~~               </span></span>
<span><span class="co">#&gt;    .e1_5              0.000</span></span>
<span><span class="co">#&gt;  .eta2_u2 ~~               </span></span>
<span><span class="co">#&gt;    .e1_5              0.000</span></span>
<span><span class="co">#&gt;  .eta1_u3 ~~               </span></span>
<span><span class="co">#&gt;    .e1_5              0.000</span></span>
<span><span class="co">#&gt;  .eta2_u3 ~~               </span></span>
<span><span class="co">#&gt;    .e1_5              0.000</span></span>
<span><span class="co">#&gt;  .eta1_u4 ~~               </span></span>
<span><span class="co">#&gt;    .e1_5              0.000</span></span>
<span><span class="co">#&gt;  .eta2_u4 ~~               </span></span>
<span><span class="co">#&gt;    .e1_5              0.000</span></span>
<span><span class="co">#&gt;  .eta2_u5 ~~               </span></span>
<span><span class="co">#&gt;    .Y1_1              0.000</span></span>
<span><span class="co">#&gt;    .Y2_1              0.000</span></span>
<span><span class="co">#&gt;    .Y1_2              0.000</span></span>
<span><span class="co">#&gt;    .Y2_2              0.000</span></span>
<span><span class="co">#&gt;    .Y1_3              0.000</span></span>
<span><span class="co">#&gt;    .Y2_3              0.000</span></span>
<span><span class="co">#&gt;    .Y1_4              0.000</span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;   eta1_u1 ~~               </span></span>
<span><span class="co">#&gt;    .e2_5              0.000</span></span>
<span><span class="co">#&gt;   eta2_u1 ~~               </span></span>
<span><span class="co">#&gt;    .e2_5              0.000</span></span>
<span><span class="co">#&gt;  .eta1_u2 ~~               </span></span>
<span><span class="co">#&gt;    .e2_5              0.000</span></span>
<span><span class="co">#&gt;  .eta2_u2 ~~               </span></span>
<span><span class="co">#&gt;    .e2_5              0.000</span></span>
<span><span class="co">#&gt;  .eta1_u3 ~~               </span></span>
<span><span class="co">#&gt;    .e2_5              0.000</span></span>
<span><span class="co">#&gt;  .eta2_u3 ~~               </span></span>
<span><span class="co">#&gt;    .e2_5              0.000</span></span>
<span><span class="co">#&gt;  .eta1_u4 ~~               </span></span>
<span><span class="co">#&gt;    .e2_5              0.000</span></span>
<span><span class="co">#&gt;  .eta2_u4 ~~               </span></span>
<span><span class="co">#&gt;    .e2_5              0.000</span></span>
<span><span class="co">#&gt;  .eta1_u5 ~~               </span></span>
<span><span class="co">#&gt;    .e2_5 (c_2_1_5)    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;    .Y1_u1     (m1)    2.503</span></span>
<span><span class="co">#&gt;    .Y2_u1     (m2)    2.843</span></span>
<span><span class="co">#&gt;    .Y1_u2     (m1)    2.698</span></span>
<span><span class="co">#&gt;    .Y2_u2     (m2)    2.877</span></span>
<span><span class="co">#&gt;    .Y1_u3     (m1)    2.822</span></span>
<span><span class="co">#&gt;    .Y2_u3     (m2)    2.951</span></span>
<span><span class="co">#&gt;    .Y1_u4     (m1)    2.657</span></span>
<span><span class="co">#&gt;    .Y2_u4     (m2)    2.935</span></span>
<span><span class="co">#&gt;    .Y1_u5     (m1)    2.509</span></span>
<span><span class="co">#&gt;    .Y2_u5     (m2)    2.794</span></span>
<span><span class="co">#&gt;     eta1_u1 (iM_1)    0.000</span></span>
<span><span class="co">#&gt;     eta2_u1 (iM_2)    0.000</span></span>
<span><span class="co">#&gt;    .eta1_u2           0.000</span></span>
<span><span class="co">#&gt;    .eta2_u2           0.000</span></span>
<span><span class="co">#&gt;    .eta1_u3           0.000</span></span>
<span><span class="co">#&gt;    .eta2_u3           0.000</span></span>
<span><span class="co">#&gt;    .eta1_u4           0.000</span></span>
<span><span class="co">#&gt;    .eta2_u4           0.000</span></span>
<span><span class="co">#&gt;    .eta1_u5           0.000</span></span>
<span><span class="co">#&gt;    .eta2_u5           0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;    .Y1_1              0.000</span></span>
<span><span class="co">#&gt;    .Y2_1              0.000</span></span>
<span><span class="co">#&gt;    .Y1_2              0.000</span></span>
<span><span class="co">#&gt;    .Y2_2              0.000</span></span>
<span><span class="co">#&gt;    .Y1_3              0.000</span></span>
<span><span class="co">#&gt;    .Y2_3              0.000</span></span>
<span><span class="co">#&gt;    .Y1_4              0.000</span></span>
<span><span class="co">#&gt;    .Y2_4              0.000</span></span>
<span><span class="co">#&gt;    .Y1_5              0.000</span></span>
<span><span class="co">#&gt;    .Y2_5              0.000</span></span>
<span><span class="co">#&gt;     e1_1    (iC_1)    0.050</span></span>
<span><span class="co">#&gt;     e2_1    (iC_2)    0.050</span></span>
<span><span class="co">#&gt;    .e1_2 (c_1_1_2)    0.050</span></span>
<span><span class="co">#&gt;    .e2_2 (c_2_2_2)    0.050</span></span>
<span><span class="co">#&gt;    .e1_3 (c_1_1_3)    0.050</span></span>
<span><span class="co">#&gt;    .e2_3 (c_2_2_3)    0.050</span></span>
<span><span class="co">#&gt;    .e1_4 (c_1_1_4)    0.050</span></span>
<span><span class="co">#&gt;    .e2_4 (c_2_2_4)    0.050</span></span>
<span><span class="co">#&gt;    .e1_5 (c_1_1_5)    0.050</span></span>
<span><span class="co">#&gt;    .e2_5 (c_2_2_5)    0.050</span></span></code></pre></div>
</details><details><summary>
Show transformation details
</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">ctsem</span><span class="op">$</span><span class="va">transformation</span><span class="op">)</span></span>
<span><span class="co">#&gt; parameters: drift_d_eta1_eta1, log_diffusion_d_eta1_d_eta1, drift_d_eta1_eta2, diffusion_d_eta1_d_eta2, drift_d_eta2_eta1, drift_d_eta2_eta2, log_diffusion_d_eta2_d_eta2, arcl_1_1_u2, arcl_2_1_u2, arcl_1_2_u2, arcl_2_2_u2, cov_1_1_u2, cov_2_1_u2, cov_2_2_u2, arcl_1_1_u3, arcl_2_1_u3, arcl_1_2_u3, arcl_2_2_u3, cov_1_1_u3, cov_2_1_u3, cov_2_2_u3, arcl_1_1_u4, arcl_2_1_u4, arcl_1_2_u4, arcl_2_2_u4, cov_1_1_u4, cov_2_1_u4, cov_2_2_u4, arcl_1_1_u5, arcl_2_1_u5, arcl_1_2_u5, arcl_2_2_u5, cov_1_1_u5, cov_2_1_u5, cov_2_2_u5</span></span>
<span><span class="co">#&gt; start: drift_d_eta1_eta1 = -0.45, log_diffusion_d_eta1_d_eta1 = 0.2, drift_d_eta1_eta2 = -0.05, diffusion_d_eta1_d_eta2 = 0.1, drift_d_eta2_eta1 = -0.05, drift_d_eta2_eta2 = -0.45, log_diffusion_d_eta2_d_eta2 = 0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; double tmpvalue = 0.0;</span></span>
<span><span class="co">#&gt; bool DRIFTChanged = false;</span></span>
<span><span class="co">#&gt; arma::mat DRIFT = transformationList["DRIFT"];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; tmpvalue = DRIFT(0,0);</span></span>
<span><span class="co">#&gt; if(tmpvalue != drift_d_eta1_eta1){</span></span>
<span><span class="co">#&gt;  DRIFTChanged = true;</span></span>
<span><span class="co">#&gt;  DRIFT(0,0) = drift_d_eta1_eta1;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt;                            </span></span>
<span><span class="co">#&gt; tmpvalue = DRIFT(0,1);</span></span>
<span><span class="co">#&gt; if(tmpvalue != drift_d_eta1_eta2){</span></span>
<span><span class="co">#&gt;  DRIFTChanged = true;</span></span>
<span><span class="co">#&gt;  DRIFT(0,1) = drift_d_eta1_eta2;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt;                            </span></span>
<span><span class="co">#&gt; tmpvalue = DRIFT(1,0);</span></span>
<span><span class="co">#&gt; if(tmpvalue != drift_d_eta2_eta1){</span></span>
<span><span class="co">#&gt;  DRIFTChanged = true;</span></span>
<span><span class="co">#&gt;  DRIFT(1,0) = drift_d_eta2_eta1;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt;                            </span></span>
<span><span class="co">#&gt; tmpvalue = DRIFT(1,1);</span></span>
<span><span class="co">#&gt; if(tmpvalue != drift_d_eta2_eta2){</span></span>
<span><span class="co">#&gt;  DRIFTChanged = true;</span></span>
<span><span class="co">#&gt;  DRIFT(1,1) = drift_d_eta2_eta2;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt;                            </span></span>
<span><span class="co">#&gt; if(DRIFTChanged) {transformationList["DRIFT"] = DRIFT;}</span></span>
<span><span class="co">#&gt; arma::mat driftHash = transformationList["driftHash"];</span></span>
<span><span class="co">#&gt; if(DRIFTChanged){</span></span>
<span><span class="co">#&gt;  driftHash = kron(DRIFT, arma::eye(2,2))+ kron(arma::eye(2,2), DRIFT);</span></span>
<span><span class="co">#&gt; transformationList["driftHash"] = driftHash;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; bool logDiagDIFFUSIONChanged = false;</span></span>
<span><span class="co">#&gt; arma::mat logDiagDIFFUSION = transformationList["logDiagDIFFUSION"];</span></span>
<span><span class="co">#&gt; arma::mat DIFFUSION = transformationList["DIFFUSION"];</span></span>
<span><span class="co">#&gt; tmpvalue = logDiagDIFFUSION(0,0);</span></span>
<span><span class="co">#&gt; if(tmpvalue != log_diffusion_d_eta1_d_eta1){</span></span>
<span><span class="co">#&gt;  logDiagDIFFUSIONChanged = true;</span></span>
<span><span class="co">#&gt;  logDiagDIFFUSION(0,0) = log_diffusion_d_eta1_d_eta1;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; tmpvalue = logDiagDIFFUSION(0,1);</span></span>
<span><span class="co">#&gt; if(tmpvalue != diffusion_d_eta1_d_eta2){</span></span>
<span><span class="co">#&gt;  logDiagDIFFUSIONChanged = true;</span></span>
<span><span class="co">#&gt;  logDiagDIFFUSION(0,1) = diffusion_d_eta1_d_eta2;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; tmpvalue = logDiagDIFFUSION(1,0);</span></span>
<span><span class="co">#&gt; if(tmpvalue != diffusion_d_eta1_d_eta2){</span></span>
<span><span class="co">#&gt;  logDiagDIFFUSIONChanged = true;</span></span>
<span><span class="co">#&gt;  logDiagDIFFUSION(1,0) = diffusion_d_eta1_d_eta2;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; tmpvalue = logDiagDIFFUSION(1,1);</span></span>
<span><span class="co">#&gt; if(tmpvalue != log_diffusion_d_eta2_d_eta2){</span></span>
<span><span class="co">#&gt;  logDiagDIFFUSIONChanged = true;</span></span>
<span><span class="co">#&gt;  logDiagDIFFUSION(1,1) = log_diffusion_d_eta2_d_eta2;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; if(logDiagDIFFUSIONChanged){transformationList["logDiagDIFFUSION"] = logDiagDIFFUSION;DIFFUSION = logDiagDIFFUSION;DIFFUSION.diag() = arma::exp(logDiagDIFFUSION.diag());transformationList["DIFFUSION"] = DIFFUSION;}</span></span>
<span><span class="co">#&gt; arma::mat ARCL_2 = transformationList["ARCL_2"];</span></span>
<span><span class="co">#&gt; if(DRIFTChanged){</span></span>
<span><span class="co">#&gt;  ARCL_2 =  arma::expmat(DRIFT*1);</span></span>
<span><span class="co">#&gt;  transformationList["ARCL_2"] = ARCL_2;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; arma::mat LVCOV_2 = transformationList["LVCOV_2"];</span></span>
<span><span class="co">#&gt; if(DRIFTChanged | logDiagDIFFUSIONChanged){</span></span>
<span><span class="co">#&gt;  LVCOV_2 = arma::reshape(arma::inv(driftHash) * (arma::expmat(driftHash*1) - arma::eye(arma::size(arma::expmat(driftHash*1))))*arma::vectorise(DIFFUSION),2,2);</span></span>
<span><span class="co">#&gt; transformationList["LVCOV_2"] = LVCOV_2;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           </span></span>
<span><span class="co">#&gt; arcl_1_1_u2 = ARCL_2(0,0);</span></span>
<span><span class="co">#&gt; arcl_1_2_u2 = ARCL_2(0,1);</span></span>
<span><span class="co">#&gt; arcl_2_1_u2 = ARCL_2(1,0);</span></span>
<span><span class="co">#&gt; arcl_2_2_u2 = ARCL_2(1,1);</span></span>
<span><span class="co">#&gt; cov_1_1_u2 = log(LVCOV_2(0,0));</span></span>
<span><span class="co">#&gt; cov_2_1_u2 = LVCOV_2(0,1);</span></span>
<span><span class="co">#&gt; cov_2_1_u2 = LVCOV_2(1,0);</span></span>
<span><span class="co">#&gt; cov_2_2_u2 = log(LVCOV_2(1,1));</span></span>
<span><span class="co">#&gt; arcl_1_1_u3 = ARCL_2(0,0);</span></span>
<span><span class="co">#&gt; arcl_1_2_u3 = ARCL_2(0,1);</span></span>
<span><span class="co">#&gt; arcl_2_1_u3 = ARCL_2(1,0);</span></span>
<span><span class="co">#&gt; arcl_2_2_u3 = ARCL_2(1,1);</span></span>
<span><span class="co">#&gt; cov_1_1_u3 = log(LVCOV_2(0,0));</span></span>
<span><span class="co">#&gt; cov_2_1_u3 = LVCOV_2(0,1);</span></span>
<span><span class="co">#&gt; cov_2_1_u3 = LVCOV_2(1,0);</span></span>
<span><span class="co">#&gt; cov_2_2_u3 = log(LVCOV_2(1,1));</span></span>
<span><span class="co">#&gt; arma::mat ARCL_3 = transformationList["ARCL_3"];</span></span>
<span><span class="co">#&gt; if(DRIFTChanged){</span></span>
<span><span class="co">#&gt;  ARCL_3 =  arma::expmat(DRIFT*2);</span></span>
<span><span class="co">#&gt;  transformationList["ARCL_3"] = ARCL_3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; arma::mat LVCOV_3 = transformationList["LVCOV_3"];</span></span>
<span><span class="co">#&gt; if(DRIFTChanged | logDiagDIFFUSIONChanged){</span></span>
<span><span class="co">#&gt;  LVCOV_3 = arma::reshape(arma::inv(driftHash) * (arma::expmat(driftHash*2) - arma::eye(arma::size(arma::expmat(driftHash*2))))*arma::vectorise(DIFFUSION),2,2);</span></span>
<span><span class="co">#&gt; transformationList["LVCOV_3"] = LVCOV_3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           </span></span>
<span><span class="co">#&gt; arcl_1_1_u4 = ARCL_3(0,0);</span></span>
<span><span class="co">#&gt; arcl_1_2_u4 = ARCL_3(0,1);</span></span>
<span><span class="co">#&gt; arcl_2_1_u4 = ARCL_3(1,0);</span></span>
<span><span class="co">#&gt; arcl_2_2_u4 = ARCL_3(1,1);</span></span>
<span><span class="co">#&gt; cov_1_1_u4 = log(LVCOV_3(0,0));</span></span>
<span><span class="co">#&gt; cov_2_1_u4 = LVCOV_3(0,1);</span></span>
<span><span class="co">#&gt; cov_2_1_u4 = LVCOV_3(1,0);</span></span>
<span><span class="co">#&gt; cov_2_2_u4 = log(LVCOV_3(1,1));</span></span>
<span><span class="co">#&gt; arcl_1_1_u5 = ARCL_3(0,0);</span></span>
<span><span class="co">#&gt; arcl_1_2_u5 = ARCL_3(0,1);</span></span>
<span><span class="co">#&gt; arcl_2_1_u5 = ARCL_3(1,0);</span></span>
<span><span class="co">#&gt; arcl_2_2_u5 = ARCL_3(1,1);</span></span>
<span><span class="co">#&gt; cov_1_1_u5 = log(LVCOV_3(0,0));</span></span>
<span><span class="co">#&gt; cov_2_1_u5 = LVCOV_3(0,1);</span></span>
<span><span class="co">#&gt; cov_2_1_u5 = LVCOV_3(1,0);</span></span>
<span><span class="co">#&gt; cov_2_2_u5 = log(LVCOV_3(1,1));</span></span>
<span><span class="co"># the following list contains elements referenced in the transformations:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ctsem</span><span class="op">$</span><span class="va">transformationList</span><span class="op">)</span></span>
<span><span class="co">#&gt; $DRIFT</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $logDiagDIFFUSION</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $DIFFUSION</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $driftHash</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    1    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    1    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    1    0</span></span>
<span><span class="co">#&gt; [4,]    0    0    0    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ARCL_2</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ARCL_3</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $LVCOV_2</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $LVCOV_3</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0</span></span></code></pre></div>
</details>
</div>
<div class="section level2">
<h2 id="fitting-the-model-with-lesssem">Fitting the model with <strong>lessSEM</strong><a class="anchor" aria-label="anchor" href="#fitting-the-model-with-lesssem"></a>
</h2>
<p>To estimate the model, we can use any of the optimizers within
<strong>lessSEM</strong>. If no regularization is required, we can use
the <code>bfgs</code> function:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jhorzek/lessSEM" class="external-link">lessSEM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lessSEM/man/bfgs.html" class="external-link">bfgs</a></span><span class="op">(</span>lavaanModel <span class="op">=</span> <span class="va">ctsem</span><span class="op">$</span><span class="va">lavaanModel</span>, </span>
<span>            modifyModel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lessSEM/man/modifyModel.html" class="external-link">modifyModel</a></span><span class="op">(</span>transformations <span class="op">=</span> <span class="va">ctsem</span><span class="op">$</span><span class="va">transformation</span>,</span>
<span>                                      transformationList <span class="op">=</span> <span class="va">ctsem</span><span class="op">$</span><span class="va">transformationList</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The parameter estimates are given by</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                                             </span></span>
<span><span class="co">#&gt;   Tuning         ||--||     Estimates                                       </span></span>
<span><span class="co">#&gt;  ------- ------- ||--|| ------------- ------------- ------------- ----------</span></span>
<span><span class="co">#&gt;   lambda   alpha ||--|| initialCov_11 initialCov_21 initialCov_22         m1</span></span>
<span><span class="co">#&gt;  ======= ======= ||--|| ============= ============= ============= ==========</span></span>
<span><span class="co">#&gt;   0.0000  0.0000 ||--||        0.6328        0.2447        0.4575     2.6871</span></span>
<span><span class="co">#&gt;                                                          </span></span>
<span><span class="co">#&gt;                                                          </span></span>
<span><span class="co">#&gt;  ---------- ------------- ------------- -----------------</span></span>
<span><span class="co">#&gt;          m2 initialMean_1 initialMean_2 drift_d_eta1_eta1</span></span>
<span><span class="co">#&gt;  ========== ============= ============= =================</span></span>
<span><span class="co">#&gt;      2.8634       -0.1837       -0.0207           -0.4474</span></span>
<span><span class="co">#&gt;                                                                       </span></span>
<span><span class="co">#&gt;                                                                       </span></span>
<span><span class="co">#&gt;  --------------------------- ----------------- -----------------------</span></span>
<span><span class="co">#&gt;  log_diffusion_d_eta1_d_eta1 drift_d_eta1_eta2 diffusion_d_eta1_d_eta2</span></span>
<span><span class="co">#&gt;  =========================== ================= =======================</span></span>
<span><span class="co">#&gt;                      -0.7480            0.2320                 -0.0046</span></span>
<span><span class="co">#&gt;                                                                 </span></span>
<span><span class="co">#&gt;                                                                 </span></span>
<span><span class="co">#&gt;  ----------------- ----------------- ---------------------------</span></span>
<span><span class="co">#&gt;  drift_d_eta2_eta1 drift_d_eta2_eta2 log_diffusion_d_eta2_d_eta2</span></span>
<span><span class="co">#&gt;  ================= ================= ===========================</span></span>
<span><span class="co">#&gt;             0.0433           -0.1174                     -1.8676</span></span></code></pre></div>
<p>Note that <code>CTSEM</code> automatically estimates the initial
covariances and means separately from all other covariances and means.
Furthermore, the diagonal elements of the diffusion matrix are
automatically log-transformed to prevent negative variances. The final
values of the drift and diffusion matrices can also be found in the
<code>ctsem$transformationList</code> object, which has been changed by
reference in C++:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DRIFT:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ctsem</span><span class="op">$</span><span class="va">transformationList</span><span class="op">$</span><span class="va">DRIFT</span><span class="op">)</span></span>
<span><span class="co">#&gt;             [,1]       [,2]</span></span>
<span><span class="co">#&gt; [1,] -0.44737262  0.2320262</span></span>
<span><span class="co">#&gt; [2,]  0.04328892 -0.1174223</span></span>
<span></span>
<span><span class="co"># DIFFUSION:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ctsem</span><span class="op">$</span><span class="va">transformationList</span><span class="op">$</span><span class="va">DIFFUSION</span><span class="op">)</span></span>
<span><span class="co">#&gt;              [,1]         [,2]</span></span>
<span><span class="co">#&gt; [1,]  0.473310689 -0.004560491</span></span>
<span><span class="co">#&gt; [2,] -0.004560491  0.154498357</span></span></code></pre></div>
<details><summary>
Compare to <strong>ctsemOMX</strong>
</summary><p>The following is copied directly from
<code>?ctsemOMX::ctFit</code></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AnomAuthmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctModel.html" class="external-link">ctModel</a></span><span class="op">(</span>LAMBDA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                                         nrow <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                                         ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, </span>
<span>                         Tpoints <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                         n.latent <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                         n.manifest <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                         MANIFESTVAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>                         TRAITVAR <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Type "omx" is still supported but requires ctsemOMX package installation. "stanct" or "standt" are recommended types.</span></span>
<span><span class="va">AnomAuthfit</span> <span class="op">&lt;-</span> <span class="fu">ctFit</span><span class="op">(</span><span class="va">AnomAuth</span>, </span>
<span>                     <span class="va">AnomAuthmodel</span><span class="op">)</span></span>
<span><span class="co">#&gt; wide format data detected</span></span>
<span><span class="co">#&gt; Running ctsemCarefulFit with 14 parameters</span></span>
<span><span class="co">#&gt; Running ctsem with 14 parameters</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Beginning initial fit attempt</span></span>
<span><span class="co">#&gt; Running ctsem with 14 parameters</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Lowest minimum so far:  23415.9290488424</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Solution found</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Solution found!  Final fit=23415.929 (started at 85223.145)  (1 attempt(s): 1 valid, 0 errors)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">AnomAuthfit</span><span class="op">)</span></span>
<span><span class="co">#&gt; $LAMBDA</span></span>
<span><span class="co">#&gt;    eta1 eta2</span></span>
<span><span class="co">#&gt; Y1    1    0</span></span>
<span><span class="co">#&gt; Y2    0    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $DRIFT</span></span>
<span><span class="co">#&gt;             eta1       eta2</span></span>
<span><span class="co">#&gt; eta1 -0.44728197  0.2324980</span></span>
<span><span class="co">#&gt; eta2  0.04329277 -0.1174662</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $MANIFESTVAR</span></span>
<span><span class="co">#&gt;    Y1 Y2</span></span>
<span><span class="co">#&gt; Y1  0  0</span></span>
<span><span class="co">#&gt; Y2  0  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $MANIFESTMEANS</span></span>
<span><span class="co">#&gt;          [,1]</span></span>
<span><span class="co">#&gt; [1,] 2.687441</span></span>
<span><span class="co">#&gt; [2,] 2.863379</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CINT</span></span>
<span><span class="co">#&gt;      [,1]</span></span>
<span><span class="co">#&gt; eta1    0</span></span>
<span><span class="co">#&gt; eta2    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $DIFFUSION</span></span>
<span><span class="co">#&gt;              eta1         eta2</span></span>
<span><span class="co">#&gt; eta1  0.473241926 -0.004610143</span></span>
<span><span class="co">#&gt; eta2 -0.004610143  0.154509563</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $T0VAR</span></span>
<span><span class="co">#&gt;           eta1      eta2</span></span>
<span><span class="co">#&gt; eta1 0.6328612 0.2447309</span></span>
<span><span class="co">#&gt; eta2 0.2447309 0.4575771</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $T0MEANS</span></span>
<span><span class="co">#&gt;             [,1]</span></span>
<span><span class="co">#&gt; eta1 -0.18401189</span></span>
<span><span class="co">#&gt; eta2 -0.02065634</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ctparameters</span></span>
<span><span class="co">#&gt;                        Value        Matrix    StdError</span></span>
<span><span class="co">#&gt; T0m_eta1        -0.184011892       T0MEANS 0.038353827</span></span>
<span><span class="co">#&gt; T0m_eta2        -0.020656344       T0MEANS 0.050200907</span></span>
<span><span class="co">#&gt; drift_eta1      -0.447281968         DRIFT 0.019876955</span></span>
<span><span class="co">#&gt; drift_eta2_eta1  0.043292775         DRIFT 0.009630974</span></span>
<span><span class="co">#&gt; drift_eta1_eta2  0.232497958         DRIFT 0.018058747</span></span>
<span><span class="co">#&gt; drift_eta2      -0.117466175         DRIFT 0.008651637</span></span>
<span><span class="co">#&gt; diff_eta1        0.473241926     DIFFUSION 0.015697557</span></span>
<span><span class="co">#&gt; diff_eta2_eta1  -0.004610143     DIFFUSION 0.005495043</span></span>
<span><span class="co">#&gt; diff_eta2        0.154509563     DIFFUSION 0.003846336</span></span>
<span><span class="co">#&gt; T0var_eta1       0.632861194         T0VAR 0.017155858</span></span>
<span><span class="co">#&gt; T0var_eta2_eta1  0.244730882         T0VAR 0.011330970</span></span>
<span><span class="co">#&gt; T0var_eta2       0.457577148         T0VAR 0.012403718</span></span>
<span><span class="co">#&gt; mm_Y1            2.687440513 MANIFESTMEANS 0.035190670</span></span>
<span><span class="co">#&gt; mm_Y2            2.863378527 MANIFESTMEANS 0.048498098</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ctparammessage</span></span>
<span><span class="co">#&gt; [1] "Note: Continuous time parameter estimates above are of the full variance-covariance matrices, not cholesky decompositions as used by ctModel."</span></span>
<span><span class="co">#&gt; [2] "Note: Standard errors are approximated with delta method so are only rough approximations."                                                   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omxsummary</span></span>
<span><span class="co">#&gt; $omxsummary$modelName</span></span>
<span><span class="co">#&gt; [1] "ctsem"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omxsummary$wallTime</span></span>
<span><span class="co">#&gt; Time difference of 0.3500328 secs</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omxsummary$mxVersion</span></span>
<span><span class="co">#&gt; [1] '2.21.1'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omxsummary$timestamp</span></span>
<span><span class="co">#&gt; [1] "2023-04-15 12:11:19 UTC"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omxsummary$estimatedParameters</span></span>
<span><span class="co">#&gt; [1] 14</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omxsummary$CI</span></span>
<span><span class="co">#&gt; data frame with 0 columns and 0 rows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omxsummary$AIC.Mx</span></span>
<span><span class="co">#&gt; [1] 23313.93</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omxsummary$BIC.Mx</span></span>
<span><span class="co">#&gt; [1] 23012.56</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omxsummary$observedStatistics</span></span>
<span><span class="co">#&gt; [1] 65</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omxsummary$&lt;NA&gt;</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omxsummary$degreesOfFreedom</span></span>
<span><span class="co">#&gt; [1] 51</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omxsummary$Minus2LogLikelihood</span></span>
<span><span class="co">#&gt; [1] 23415.93</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $message</span></span>
<span><span class="co">#&gt; [1] "For additional summary matrices and raw OpenMx parameter output, use argument verbose=TRUE"</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="adding-a-random-intercept">Adding a Random Intercept<a class="anchor" aria-label="anchor" href="#adding-a-random-intercept"></a>
</h2>
<p>Similar to the RI-CLPM (Hamaker et al., 2015), we can specify a
random intercept in CTSEM as well (Driver et al., 2017):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelRI</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st"># Specify the latent dynamics in differential equation model notation:</span></span>
<span><span class="st">d_eta1(t) ~ eta1(t) + eta2(t)</span></span>
<span><span class="st">d_eta2(t) ~ eta1(t) + eta2(t)</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Covariances (Wiener process)</span></span>
<span><span class="st">d_eta1(t) ~~ d_eta1(t) + d_eta2(t)</span></span>
<span><span class="st">d_eta2(t) ~~ d_eta2(t)</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Latent intercepts</span></span>
<span><span class="st">eta1(0) ~ 1</span></span>
<span><span class="st">eta2(0) ~ 1</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Measurement model</span></span>
<span><span class="st">eta1(t) =~ 1*Y1(t)</span></span>
<span><span class="st">eta2(t) =~ 1*Y2(t)</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Manifest variances and covariances</span></span>
<span><span class="st">Y1(t) ~~ 0*Y1(t) + 0*Y2(t)</span></span>
<span><span class="st">Y2(t) ~~ 0*Y2(t)</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Manifest intercepts</span></span>
<span><span class="st">Y1(t) ~ m1*1</span></span>
<span><span class="st">Y2(t) ~ m2*1</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Add random intercepts</span></span>
<span><span class="st">RI1 =~ 1*Y1(t)</span></span>
<span><span class="st">RI2 =~ 1*Y2(t)</span></span>
<span><span class="st"></span></span>
<span><span class="st">RI1 ~~ RI1 + RI2</span></span>
<span><span class="st">RI2 ~~ RI2</span></span>
<span><span class="st">"</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ctsemRI</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CTSEM.html">CTSEM</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">modelRI</span>, </span>
<span>                 data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="va">fitRI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lessSEM/man/bfgs.html" class="external-link">bfgs</a></span><span class="op">(</span>lavaanModel <span class="op">=</span> <span class="va">ctsemRI</span><span class="op">$</span><span class="va">lavaanModel</span>, </span>
<span>              modifyModel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lessSEM/man/modifyModel.html" class="external-link">modifyModel</a></span><span class="op">(</span>transformations <span class="op">=</span> <span class="va">ctsemRI</span><span class="op">$</span><span class="va">transformation</span>,</span>
<span>                                        transformationList <span class="op">=</span> <span class="va">ctsemRI</span><span class="op">$</span><span class="va">transformationList</span><span class="op">)</span>,</span>
<span>              control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lessSEM/man/controlBFGS.html" class="external-link">controlBFGS</a></span><span class="op">(</span>breakOuter <span class="op">=</span> <span class="fl">1e-10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The parameter estimates are given by</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fitRI</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                                             </span></span>
<span><span class="co">#&gt;   Tuning         ||--||     Estimates                                       </span></span>
<span><span class="co">#&gt;  ------- ------- ||--|| ------------- ------------- ------------- ----------</span></span>
<span><span class="co">#&gt;   lambda   alpha ||--|| initialCov_11 initialCov_21 initialCov_22   RI1~~RI1</span></span>
<span><span class="co">#&gt;  ======= ======= ||--|| ============= ============= ============= ==========</span></span>
<span><span class="co">#&gt;   0.0000  0.0000 ||--||        0.2621        0.0255        0.1819     0.3918</span></span>
<span><span class="co">#&gt;                                                                         </span></span>
<span><span class="co">#&gt;                                                                         </span></span>
<span><span class="co">#&gt;  ---------- ---------- ---------- ---------- ------------- -------------</span></span>
<span><span class="co">#&gt;    RI1~~RI2   RI2~~RI2         m1         m2 initialMean_1 initialMean_2</span></span>
<span><span class="co">#&gt;  ========== ========== ========== ========== ============= =============</span></span>
<span><span class="co">#&gt;      0.2222     0.2765     2.6904     2.8712       -0.1870       -0.0285</span></span>
<span><span class="co">#&gt;                                                                 </span></span>
<span><span class="co">#&gt;                                                                 </span></span>
<span><span class="co">#&gt;  ----------------- --------------------------- -----------------</span></span>
<span><span class="co">#&gt;  drift_d_eta1_eta1 log_diffusion_d_eta1_d_eta1 drift_d_eta1_eta2</span></span>
<span><span class="co">#&gt;  ================= =========================== =================</span></span>
<span><span class="co">#&gt;            -2.4802                      0.1429            0.2722</span></span>
<span><span class="co">#&gt;                                                             </span></span>
<span><span class="co">#&gt;                                                             </span></span>
<span><span class="co">#&gt;  ----------------------- ----------------- -----------------</span></span>
<span><span class="co">#&gt;  diffusion_d_eta1_d_eta2 drift_d_eta2_eta1 drift_d_eta2_eta2</span></span>
<span><span class="co">#&gt;  ======================= ================= =================</span></span>
<span><span class="co">#&gt;                   0.0083            0.0458           -0.2243</span></span>
<span><span class="co">#&gt;                             </span></span>
<span><span class="co">#&gt;                             </span></span>
<span><span class="co">#&gt;  ---------------------------</span></span>
<span><span class="co">#&gt;  log_diffusion_d_eta2_d_eta2</span></span>
<span><span class="co">#&gt;  ===========================</span></span>
<span><span class="co">#&gt;                      -1.7616</span></span>
<span></span>
<span><span class="co"># DRIFT:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ctsemRI</span><span class="op">$</span><span class="va">transformationList</span><span class="op">$</span><span class="va">DRIFT</span><span class="op">)</span></span>
<span><span class="co">#&gt;             [,1]       [,2]</span></span>
<span><span class="co">#&gt; [1,] -2.48019685  0.2721777</span></span>
<span><span class="co">#&gt; [2,]  0.04583106 -0.2242664</span></span>
<span></span>
<span><span class="co"># DIFFUSION:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ctsemRI</span><span class="op">$</span><span class="va">transformationList</span><span class="op">$</span><span class="va">DIFFUSION</span><span class="op">)</span></span>
<span><span class="co">#&gt;             [,1]        [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.153610333 0.008313123</span></span>
<span><span class="co">#&gt; [2,] 0.008313123 0.171776547</span></span></code></pre></div>
<p>We can compare the model with and the model without random intercepts
using the information criteria implemented in
<strong>lessSEM</strong>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;   lambda alpha     m2LL  regM2LL nonZeroParameters convergence      AIC</span></span>
<span><span class="co">#&gt; 1      0     0 23415.93 23415.93                14        TRUE 23443.93</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fitRI</span><span class="op">)</span></span>
<span><span class="co">#&gt;   lambda alpha     m2LL  regM2LL nonZeroParameters convergence      AIC</span></span>
<span><span class="co">#&gt; 1      0     0 22898.53 22898.53                17        TRUE 22932.53</span></span></code></pre></div>
<p>Note that the random-intercept CTSEM outperforms the CTSEM in terms
of the AIC.</p>
<details><summary>
Compare to <strong>ctsemOMX</strong>
</summary><p>The following is copied and adapted directly from
<code>?ctsemOMX::ctFit</code></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AnomAuthmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ctsem/man/ctModel.html" class="external-link">ctModel</a></span><span class="op">(</span>LAMBDA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                                         nrow <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                                         ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, </span>
<span>                         Tpoints <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                         n.latent <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                         n.manifest <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                         MANIFESTVAR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>                         TRAITVAR <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                         MANIFESTTRAITVAR <span class="op">=</span> <span class="st">"auto"</span> <span class="co"># add random intercepts</span></span>
<span><span class="op">)</span> </span>
<span><span class="co">#&gt; Type "omx" is still supported but requires ctsemOMX package installation. "stanct" or "standt" are recommended types.</span></span>
<span><span class="va">AnomAuthfit</span> <span class="op">&lt;-</span> <span class="fu">ctFit</span><span class="op">(</span><span class="va">AnomAuth</span>, </span>
<span>                     <span class="va">AnomAuthmodel</span><span class="op">)</span></span>
<span><span class="co">#&gt; wide format data detected</span></span>
<span><span class="co">#&gt; Running ctsemCarefulFit with 17 parameters</span></span>
<span><span class="co">#&gt; Running ctsem with 17 parameters</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Beginning initial fit attempt</span></span>
<span><span class="co">#&gt; Running ctsem with 17 parameters</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Lowest minimum so far:  22898.5323204156</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Solution found</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Solution found!  Final fit=22898.532 (started at 85747.133)  (1 attempt(s): 1 valid, 0 errors)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">AnomAuthfit</span><span class="op">$</span><span class="va">mxobj</span><span class="op">$</span><span class="va">DRIFT</span><span class="op">$</span><span class="va">values</span><span class="op">)</span></span>
<span><span class="co">#&gt;             [,1]       [,2]</span></span>
<span><span class="co">#&gt; [1,] -2.48022784  0.2723562</span></span>
<span><span class="co">#&gt; [2,]  0.04594447 -0.2242828</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<ul>
<li>Driver, C. C., Oud, J. H. L., &amp; Voelkle, M. C. (2017).
Continuous Time Structural Equation Modelling With R Package ctsem.
Journal of Statistical Software, 77(5), 1–36. <a href="https://doi.org/10.18637/jss.v077.i05" class="external-link uri">https://doi.org/10.18637/jss.v077.i05</a>
</li>
<li>Hamaker, E. L., Kuiper, R. M., &amp; Grasman, R. P. P. P. (2015). A
critique of the cross-lagged panel model. Psychological Methods, 20(1),
102–116. <a href="https://doi.org/10.1037/a0038889" class="external-link uri">https://doi.org/10.1037/a0038889</a>
</li>
<li>Orzek, J. H., &amp; Voelkle, M. C. (In Press). Regularized
Continuous Time Dynamic Networks. Psychological Methods.</li>
<li>Voelkle, M. C., Oud, J. H. L., Davidov, E., &amp; Schmidt, P.
(2012). An SEM Approach to Continuous Time Modeling of Panel Data:
Relating Authoritarianism and Anomia. Psychological Methods, 17(2),
176–192. <a href="https://doi.org/10.1037/a0027543" class="external-link uri">https://doi.org/10.1037/a0027543</a>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jannik H. Orzek.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
